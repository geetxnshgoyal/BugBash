<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32.png"/>
<link rel="icon" type="image/png" sizes="48x48" href="/assets/favicon-48.png"/>
<link rel="icon" type="image/png" sizes="192x192" href="/assets/favicon-192.png"/>
<link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"/>
<link rel="icon" type="image/x-icon" href="/favicon.ico"/>
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
<title>Register Bug Bash 2025</title>
<meta name="description" content="Register for Bug Bash 2025 at SVYASA Bengaluru. Share your project idea, tools, and contact details.">
<link rel="canonical" href="https://bugbash.me/register"/>
<meta property="og:type" content="website"/>
<meta property="og:title" content="Register for Bug Bash 2025"/>
<meta property="og:description" content="Reserve your spot at Bug Bash 2025, the NST×SVYASA student hackathon in Bengaluru."/>
<meta property="og:url" content="https://bugbash.me/register"/>
<meta property="og:image" content="https://bugbash.me/assets/bugbash_logo.png"/>
<meta property="og:locale" content="en_IN"/>
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:title" content="Register for Bug Bash 2025"/>
<meta name="twitter:description" content="Apply now to build at Bug Bash 2025 across aviation, AI, fintech, health, sustainability, and immersive media."/>
<meta name="twitter:image" content="https://bugbash.me/assets/bugbash_logo.png"/>
<meta name="author" content="Bug Bash team"/>
<meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1"/>
<meta name="theme-color" content="#0f1720"/>
<link rel="alternate" href="https://bugbash.me/register" hreflang="en"/>
<link rel="alternate" href="https://bugbash.me/register" hreflang="x-default"/>
<script src="/env.js"></script>
<script>
  window.si = window.si || function () {
    (window.siq = window.siq || []).push(arguments);
  };
</script>
<script defer src="https://va.vercel-scripts.com/v1/speed-insights/script.js" data-sdkn="@vercel/speed-insights" data-sdkv="1.2.0" data-route="/register" data-endpoint="https://va.vercel-scripts.com/v1/speed-insights"></script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "@id": "https://bugbash.me/register#webpage",
  "url": "https://bugbash.me/register",
  "name": "Register for Bug Bash 2025",
  "description": "Register for Bug Bash 2025 at SVYASA Bengaluru. Share your project idea, tools, and contact details.",
  "isPartOf": { "@id": "https://bugbash.me/#website" },
  "inLanguage": "en-IN"
}
</script>
<style>
  :root{--bg1:#0f1720;--bg2:#0b1020;--accent:#7be04a;--glass:rgba(255,255,255,0.06);
    --muted:#97a0ad;--glass2:rgba(255,255,255,0.03);--white:#f7f8fa;--shadow:0 12px 30px rgba(2,6,23,0.6);
    --mono:'Segoe UI',Roboto,Helvetica,Arial,system-ui}
  html,body{height:100%;margin:0;font-family:var(--mono);background:
    radial-gradient(1200px 600px at 10% 10%, rgba(123,224,74,0.03), transparent),
    linear-gradient(180deg,var(--bg1),var(--bg2));color:var(--white)}
  #bg-canvas{position:fixed;inset:0;z-index:0;pointer-events:none;opacity:.65}
  .wrap{position:relative;z-index:2;max-width:1080px;margin:32px auto;padding:28px}
  [data-animate]{opacity:0;transform:translateY(28px);transition:opacity .7s ease,transform .7s ease;will-change:opacity,transform}
  [data-animate].is-visible{opacity:1;transform:translateY(0)}
  a{color:var(--accent)}
  header{display:flex;justify-content:space-between;align-items:center;gap:18px;padding:8px 0 24px}
  .brand{font-weight:800;font-size:20px;letter-spacing:.6px}
  .back-link{color:var(--muted);text-decoration:none;font-size:14px;display:inline-flex;align-items:center;gap:6px}
  .panel{position:relative;background:linear-gradient(180deg,var(--glass),transparent);padding:28px;border-radius:14px;box-shadow:var(--shadow);backdrop-filter:blur(6px);overflow:hidden}
  .panel::after{content:'';position:absolute;inset:-30%;background:radial-gradient(circle at center,rgba(123,224,74,0.12) 0,rgba(123,224,74,0) 60%);opacity:0;animation:panel-glow 7s ease-in-out infinite;pointer-events:none}
  .hero{display:grid;grid-template-columns:360px 1fr;gap:32px;align-items:flex-start}
  @media(max-width:980px){.hero{grid-template-columns:1fr;}}
  .title{font-size:36px;margin:0 0 10px}
  .glitch{position:relative;display:inline-block;font-weight:900;color:var(--white);filter:drop-shadow(0 8px 30px rgba(0,0,0,0.6))}
  .glitch::before,.glitch::after{content:attr(data-text);position:absolute;left:0;top:0;opacity:.6;mix-blend-mode:screen}
  .glitch::before{color:#ff3b81;transform:translate(4px,-2px);clip-path:polygon(0 0,100% 0,100% 45%,0 45%);animation:glitch-top .9s linear infinite}
  .glitch::after{color:#33c2ff;transform:translate(-5px,3px);clip-path:polygon(0 55%,100% 55%,100% 100%,0 100%);animation:glitch-bottom 1.2s linear infinite}
  .lead{color:var(--muted);margin:0 0 24px;font-size:16px}
  .checklist{list-style:disc;margin:16px 0 0 20px;padding:0;display:grid;gap:10px;color:var(--muted);font-size:14px}
  label{display:flex;flex-direction:column;gap:6px;font-size:13px;color:var(--muted);margin-bottom:14px}
  .label-line{display:flex;align-items:center;gap:6px;font-weight:600;color:inherit}
  .field-optional{font-size:12px;color:var(--muted);opacity:.85;font-weight:500}
  input,select,textarea{padding:11px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.12);
    background:rgba(6,18,23,0.45);color:var(--white);font-size:15px;font-family:inherit}
  input[type="date"]::-webkit-calendar-picker-indicator{filter:invert(1) brightness(1.4);opacity:.85;cursor:pointer}
  input[type="date"]::-moz-focus-inner{border:0}
  input:focus,select:focus,textarea:focus{outline:2px solid rgba(123,224,74,0.55);outline-offset:1px}
  textarea{resize:vertical;min-height:96px}
  form .field-row{display:grid;gap:16px}
  @media(min-width:720px){form .field-row.two{grid-template-columns:1fr 1fr}}
  .btn{background:var(--accent);color:#061217;padding:12px 18px;border-radius:10px;font-weight:700;text-decoration:none;display:inline-flex;align-items:center;justify-content:center;gap:10px;box-shadow:0 8px 20px rgba(123,224,74,0.12);transition:transform .2s ease,box-shadow .2s ease;border:none;cursor:pointer;font-size:15px}
  .btn:hover{transform:translateY(-2px);box-shadow:0 12px 26px rgba(123,224,74,0.22)}
  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.16);color:var(--white)}
  .btn.is-submitting{position:relative;pointer-events:none}
  .btn.is-submitting::after{content:'';width:16px;height:16px;border-radius:50%;border:2px solid rgba(6,18,23,0.2);border-top-color:rgba(6,18,23,0.75);animation:spin .75s linear infinite}
  .btn--github{background:rgba(255,255,255,0.08);color:var(--white);border:1px solid rgba(255,255,255,0.22);box-shadow:none}
  .btn--github:hover{box-shadow:0 10px 24px rgba(15,23,42,0.35)}
  .btn--github svg{width:20px;height:20px;fill:var(--white)}
  .github-auth.is-connected{border-color:rgba(123,224,74,0.4);box-shadow:0 0 0 1px rgba(123,224,74,0.2)}
  .form-actions{display:flex;gap:12px;margin-top:14px;flex-wrap:wrap}
  .form-actions .btn{flex:1 0 180px;text-align:center}
  .note{font-size:13px;color:var(--muted);margin-top:10px}
  .note.note--success{color:var(--accent)}
  .note.note--error{color:#fca5a5}
  .github-auth{display:flex;flex-direction:column;gap:12px;margin-bottom:24px;padding:18px;border-radius:12px;background:linear-gradient(180deg,var(--glass2),transparent);border:1px solid rgba(255,255,255,0.08)}
  .github-auth[hidden]{display:none}
  .github-auth__hint{font-size:13px;color:var(--muted);margin:0}
  .github-auth__user{font-size:13px;color:var(--accent);margin:0}
  .github-auth__user[hidden]{display:none}
  .form-divider{display:flex;align-items:center;justify-content:center;gap:12px;font-size:12px;text-transform:uppercase;letter-spacing:0.18em;color:var(--muted);margin:18px 0 16px;white-space:nowrap}
  .form-divider::before,.form-divider::after{content:'';flex:1;height:1px;background:rgba(255,255,255,0.12)}
  footer{text-align:center;color:var(--muted);font-size:13px;margin-top:48px;padding:16px;display:flex;flex-direction:column;gap:14px;align-items:center;background:rgba(255,255,255,0.02);border-radius:12px}
  footer p{margin:0}
  .social-links{display:flex;gap:16px;justify-content:center;flex-wrap:wrap}
  .social-links a{display:inline-flex;align-items:center;gap:8px;padding:8px 14px;border-radius:999px;background:rgba(123,224,74,0.12);color:var(--white);text-decoration:none;transition:transform .2s ease,background .2s ease}
  .social-links a:hover{transform:translateY(-2px);background:rgba(123,224,74,0.28)}
  .social-links svg{width:18px;height:18px;fill:currentColor}
  .social-links span{font-size:12px;font-weight:600;color:var(--muted);letter-spacing:.02em}
  .social-links a:hover span{color:var(--white)}
  .floating-bug{position:fixed;bottom:28px;right:28px;width:60px;height:60px;display:flex;
    align-items:center;justify-content:center;background:linear-gradient(180deg,var(--glass),transparent);
    border:1px solid rgba(255,255,255,0.12);border-radius:50%;box-shadow:var(--shadow);
    backdrop-filter:blur(6px);z-index:3;transition:transform .2s ease,box-shadow .2s ease;animation:bob 4.4s ease-in-out infinite .6s,ring 5.4s linear infinite}
  .floating-bug:hover{transform:translateY(-2px);box-shadow:0 14px 32px rgba(2,6,23,0.7)}
  .floating-bug img{width:38px;height:38px;display:block;border-radius:50%;object-fit:cover}
  .modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(3,10,18,0.72);backdrop-filter:blur(6px);z-index:30;padding:20px;transition:opacity .3s ease}
  .modal[hidden]{display:none}
  .modal__panel{background:linear-gradient(180deg,var(--glass),transparent);border-radius:18px;padding:28px;max-width:360px;width:100%;text-align:center;box-shadow:0 24px 46px rgba(2,6,23,0.66);border:1px solid rgba(255,255,255,0.12)}
  .modal__panel h3{margin:0 0 12px;font-size:20px;letter-spacing:.04em}
  .modal__panel p{margin:0 0 18px;color:var(--muted);font-size:14px}
  .modal__actions{display:flex;justify-content:center}
  @keyframes panel-glow{0%,100%{opacity:0;transform:scale(0.7)}40%{opacity:.35;transform:scale(1)}}
  @keyframes glitch-top{0%{transform:translate(4px,-2px)}50%{transform:translate(2px,1px)}100%{transform:translate(4px,-2px)}}
  @keyframes glitch-bottom{0%{transform:translate(-5px,3px)}50%{transform:translate(-2px,6px)}100%{transform:translate(-5px,3px)}}
  @keyframes bob{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
  @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
  @keyframes ring{0%{box-shadow:0 18px 34px rgba(123,224,74,0.08),0 0 0 0 rgba(123,224,74,0.15)}70%{box-shadow:0 18px 34px rgba(123,224,74,0.18),0 0 0 14px rgba(123,224,74,0)}100%{box-shadow:0 18px 34px rgba(123,224,74,0.08),0 0 0 0 rgba(123,224,74,0)}}
  @media(prefers-reduced-motion:reduce){
    *,*::before,*::after{animation-duration:.01ms!important;animation-iteration-count:1!important;
      transition-duration:.01ms!important;scroll-behavior:auto!important}
  }
</style>
</head>
<body>
<canvas id="bg-canvas"></canvas>
<div class="wrap">
  <header>
    <div class="brand" data-animate>BUG BASH <span style="color:var(--accent)">2025</span></div>
    <a class="back-link" href="/" data-animate>&larr; Back to homepage</a>
  </header>
  <main class="hero">
    <section class="panel" data-animate>
      <h1 class="title"><span class="glitch" data-text="Tell us about your build">Tell us about your build</span></h1>
      <p class="lead">We review every submission, pair up teams where needed, and send you logistics details before kickoff. Share enough context so mentors can support you from the get-go.</p>
      <ul class="checklist">
        <li>Open to participants aged 16–22 only add accurate DOB so we can verify eligibility.</li>
        <li>Tell us how you heard about Bug Bash and what excites you about it.</li>
        <li>Drop any relevant GitHub/portfolio links so we know your style.</li>
      </ul>
      <p class="note" style="margin-top:18px;font-size:16px">Need help? Email <a href="mailto:contact@bugbash.me">contact@bugbash.me</a></p>
    </section>

    <section class="panel" data-animate>
      <form id="regForm" novalidate>
        <div class="github-auth" data-github-auth hidden>
          <button type="button" class="btn btn--github" id="githubSignIn">
            <svg viewBox="0 0 16 16" focusable="false" aria-hidden="true">
              <path d="M8 0a8 8 0 0 0-2.53 15.6c.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.24-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.22 1.87.88 2.33.67.07-.52.28-.88.51-1.08-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.01.08-2.11 0 0 .67-.21 2.2.82a7.62 7.62 0 0 1 4.01 0c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.91.08 2.11.51.56.82 1.28.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.19 0 .21.15.46.55.38A8 8 0 0 0 8 0"/>
            </svg>
            <span>Continue with GitHub</span>
          </button>
          <p class="github-auth__hint">Connect with GitHub to unlock the registration form. Your phone number stays private.</p>
          <p class="github-auth__user" data-github-user hidden></p>
          <p class="note" id="githubStatus" role="status" aria-live="polite" hidden></p>
        </div>
        <div class="form-body" data-form-body hidden>
          <div class="form-divider" aria-hidden="true">Complete your registration</div>
          <div class="field-row two">
            <label>Full name
              <input name="full_name" placeholder="Full name" autocomplete="name" required>
            </label>
            <label>Email
              <input type="email" name="email" placeholder="you@example.com" autocomplete="email" required pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[A-Za-z]{2,}$">
            </label>
          </div>
          <div class="field-row two">
            <label>Phone number
              <input type="tel" name="phone" value="+91" placeholder="Enter 10-digit number" autocomplete="tel" required>
            </label>
            <label>Date of birth
              <input type="date" name="dob" autocomplete="bday" required>
            </label>
          </div>
          <div class="field-row two">
            <label>T-shirt size
              <select name="size" required>
                <option value="">Select a size</option>
                <option value="S">S</option>
                <option value="M">M</option>
                <option value="L">L</option>
                <option value="XL">XL</option>
                <option value="XXL">XXL</option>
              </select>
            </label>
            <label><span class="label-line">Profile link <span class="field-optional">(optional)</span></span>
              <input type="url" name="profile_link" placeholder="https://linkedin.com/in/...">
            </label>
          </div>
          <label>How did you hear about us?
            <textarea name="referral" placeholder="Friends, social media, campus announcement, etc." required></textarea>
          </label>
          <label><span class="label-line">Additional notes for organizers <span class="field-optional">(optional)</span></span>
            <textarea name="notes" placeholder="Dietary needs, travel info, accessibility, etc." rows="2"></textarea>
          </label>
          <div class="form-actions">
            <button class="btn" type="submit">Submit registration</button>
            <button type="button" class="btn ghost" id="cancelBtn">Cancel</button>
          </div>
          <div id="formMsg" class="note" role="status" aria-live="polite" hidden></div>
        </div>
      </form>
    </section>
  </main>
  <footer data-animate>
    <p>© Bug Bash 2025 • SVYASA Deemed to be University, Bengaluru • <a href="mailto:contact@bugbash.me">contact@bugbash.me</a></p>
    <div class="social-links">
      <a href="https://www.linkedin.com/company/bugbashme/" aria-label="Bug Bash on LinkedIn" target="_blank" rel="noopener noreferrer">
        <svg viewBox="0 0 24 24" role="img" aria-hidden="true">
          <path d="M4.98 3.5a2.5 2.5 0 1 1-.02 5 2.5 2.5 0 0 1 .02-5zM3 8.71h3.95V20H3zM9.5 8.71h3.77v1.54h.05c.52-.98 1.8-2.01 3.7-2.01 3.96 0 4.7 2.6 4.7 6V20h-3.94v-5.59c0-1.33-.02-3.05-1.86-3.05-1.86 0-2.15 1.45-2.15 2.95V20H9.5z"/>
        </svg>
        <span>LinkedIn /bugbashme</span>
      </a>
      <a href="https://instagram.com/bugbashme" aria-label="Bug Bash on Instagram" target="_blank" rel="noopener noreferrer">
        <svg viewBox="0 0 24 24" role="img" aria-hidden="true">
          <path d="M12 7.3a4.7 4.7 0 1 0 0 9.4 4.7 4.7 0 0 0 0-9.4zm0 7.7a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm6-7.8a1.1 1.1 0 1 1-2.2 0 1.1 1.1 0 0 1 2.2 0z"/>
          <path d="M20.7 6.5a4.5 4.5 0 0 0-1.2-3 4.5 4.5 0 0 0-3-1.2C15 2.1 9 2.1 7.5 2.3a4.5 4.5 0 0 0-3 1.2 4.5 4.5 0 0 0-1.2 3C3.1 8 3.1 14 3.3 15.5a4.5 4.5 0 0 0 1.2 3 4.5 4.5 0 0 0 3 1.2c1.5.2 7.5.2 9 0a4.5 4.5 0 0 0 3-1.2 4.5 4.5 0 0 0 1.2-3c.2-1.5.2-7.5 0-9zm-1.9 9.6a2.6 2.6 0 0 1-1.5 1.5c-1 .4-3.3.3-4.4.3s-3.4.1-4.4-.3a2.6 2.6 0 0 1-1.5-1.5c-.4-1-.3-3.3-.3-4.4s-.1-3.4.3-4.4a2.6 2.6 0 0 1 1.5-1.5c1-.4 3.3-.3 4.4-.3s3.4-.1 4.4.3a2.6 2.6 0 0 1 1.5 1.5c.4 1 .3 3.3.3 4.4s.1 3.4-.3 4.4z"/>
        </svg>
        <span>Instagram @bugbashme</span>
      </a>
    </div>
  </footer>
</div>
<div class="modal" id="successModal" hidden>
  <div class="modal__panel">
    <h3>Registration received!</h3>
    <p id="successMessage">We'll send you a confirmation email shortly.</p>
    <div class="modal__actions">
      <button type="button" class="btn" id="successClose">Go to homepage</button>
    </div>
  </div>
</div>
<a class="floating-bug" href="/" title="Back to homepage">
  <img src="/assets/bugbash_logo.png" alt="Bug Bash logo" onerror="this.src='/assets/bugbash_logo.png?bust=1'">
</a>
<script>
if('onpageshow' in window){
  window.addEventListener('pageshow',event=>{
    if(event.persisted){
      window.location.reload();
    }
  });
}
/* bg */
const canvas=document.getElementById('bg-canvas');
const ctx=canvas.getContext('2d');
let width=canvas.width=innerWidth;
let height=canvas.height=innerHeight;
const particles=[];
const pulses=[];

const random=(min,max)=>Math.random()*(max-min)+min;

const rebuildParticles=()=>{
  const count=Math.max(45,Math.floor((width*height)/60000));
  particles.length=0;
  for(let i=0;i<count;i++){
    particles.push({
      x:random(0,width),
      y:random(0,height),
      r:random(.6,2.8),
      vx:random(-.45,.65),
      vy:random(-.25,.45)
    });
  }

  const pulseCount=Math.max(6,Math.floor(width/260));
  pulses.length=0;
  for(let i=0;i<pulseCount;i++){
    pulses.push({
      x:random(0,width),
      y:random(0,height),
      radius:random(20,80),
      alpha:random(0.05,0.18),
      speed:random(0.35,0.6)
    });
  }
};

const resetPulse=pulse=>{
  pulse.x=random(0,width);
  pulse.y=random(0,height);
  pulse.radius=random(18,60);
  pulse.alpha=random(0.05,0.16);
  pulse.speed=random(0.32,0.55);
};

const resize=()=>{
  width=canvas.width=innerWidth;
  height=canvas.height=innerHeight;
  rebuildParticles();
};
addEventListener('resize',resize);

const draw=()=>{
  ctx.clearRect(0,0,width,height);
  const gradient=ctx.createLinearGradient(0,0,width,height);
  gradient.addColorStop(0,'rgba(11,16,32,0.16)');
  gradient.addColorStop(1,'rgba(2,4,10,0.22)');
  ctx.fillStyle=gradient;
  ctx.fillRect(0,0,width,height);

  for(const pulse of pulses){
    pulse.radius+=pulse.speed;
    pulse.alpha-=0.0015;
    if(pulse.alpha<=0){
      resetPulse(pulse);
    }
    const grd=ctx.createRadialGradient(pulse.x,pulse.y,0,pulse.x,pulse.y,pulse.radius);
    grd.addColorStop(0,`rgba(123,224,74,${pulse.alpha})`);
    grd.addColorStop(1,'rgba(123,224,74,0)');
    ctx.fillStyle=grd;
    ctx.beginPath();
    ctx.arc(pulse.x,pulse.y,pulse.radius,0,Math.PI*2);
    ctx.fill();
  }

  for(const p of particles){
    p.x+=p.vx;
    p.y+=p.vy;
    if(p.x<-20)p.x=width+20;
    if(p.x>width+20)p.x=-20;
    if(p.y<-20)p.y=height+20;
    if(p.y>height+20)p.y=-20;

    ctx.beginPath();
    ctx.fillStyle=`rgba(123,224,74,${0.07+p.r/6})`;
    ctx.shadowColor='rgba(123,224,74,0.25)';
    ctx.shadowBlur=6;
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    ctx.fill();
  }
  ctx.shadowBlur=0;

  const limit=Math.min(particles.length,150);
  for(let i=0;i<limit;i++){
    const a=particles[i];
    for(let j=i+1;j<limit;j++){
      const b=particles[j];
      const dx=a.x-b.x;
      const dy=a.y-b.y;
      const distSq=dx*dx+dy*dy;
      if(distSq<9000){
        ctx.beginPath();
        ctx.strokeStyle=`rgba(123,224,74,${0.003+(9000-distSq)/11000})`;
        ctx.lineWidth=0.8;
        ctx.moveTo(a.x,a.y);
        ctx.lineTo(b.x,b.y);
        ctx.stroke();
      }
    }
  }

  requestAnimationFrame(draw);
};

rebuildParticles();
draw();
/* animations */
const animated=document.querySelectorAll('[data-animate]');
const prefersReduced=matchMedia('(prefers-reduced-motion: reduce)').matches;
if(animated.length){
  if(prefersReduced){animated.forEach(el=>el.classList.add('is-visible'));}
  else{
    const io=new IntersectionObserver((entries,observer)=>{
      entries.forEach(entry=>{
        if(entry.isIntersecting){
          entry.target.classList.add('is-visible');
          observer.unobserve(entry.target);
        }
      });
    },{threshold:.2,rootMargin:'0px 0px -40px'});
    animated.forEach(el=>io.observe(el));
  }
}
/* form */
const form=document.getElementById('regForm');
const msg=document.getElementById('formMsg');
const submitBtn=form.querySelector('button[type="submit"]');
const dobInput=form.querySelector('input[name="dob"]');
const phoneInput=form.querySelector('input[name="phone"]');
const cancelBtn=document.getElementById('cancelBtn');
const successModal=document.getElementById('successModal');
const successMessage=document.getElementById('successMessage');
const successClose=document.getElementById('successClose');
const appConfig=window.__APP_CONFIG__||{};
const SITE_KEY=appConfig.recaptchaSiteKey||'';
const REGISTRATIONS_OPEN=appConfig.registrationsOpen!==false;
const GITHUB_AUTH_ENABLED=Boolean(appConfig.githubAuthEnabled);
const githubAuthBlock=document.querySelector('[data-github-auth]');
const githubBtn=document.getElementById('githubSignIn');
const githubStatus=document.getElementById('githubStatus');
const githubHint=document.querySelector('.github-auth__hint');
const githubUserLabel=document.querySelector('[data-github-user]');
const formBody=document.querySelector('[data-form-body]');
let githubSessionToken='';
let githubConnected=false;
let githubProfileData=null;
let githubAlreadyRegistered=false;
let formLocked=true;
if(formBody){
  formBody.hidden=true;
}
if(githubAuthBlock){
  if(GITHUB_AUTH_ENABLED){
    githubAuthBlock.hidden=false;
  }else{
    githubAuthBlock.hidden=false;
    if(githubBtn){
      githubBtn.disabled=true;
    }
  }
}
let recaptchaReadyPromise=null;
const submitBtnDefaultText=submitBtn.textContent.trim();
const EMAIL_REGEX=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[A-Za-z]{2,}$/;
const INDIAN_MOBILE_REGEX=/^[6-9][0-9]{9}$/;
let isSubmitting=false;

const setFormEnabled=(enabled)=>{
  const controls=form.querySelectorAll('input,select,textarea,button');
  const allow=Boolean(enabled&&REGISTRATIONS_OPEN&&!formLocked);
  controls.forEach(el=>{
    if(el.closest('#successModal')) return;
    if(el===githubBtn){
      el.disabled=!GITHUB_AUTH_ENABLED||!REGISTRATIONS_OPEN||isSubmitting;
      return;
    }
    el.disabled=!allow;
  });
};

const unlockForm=()=>{
  formLocked=false;
  if(formBody){
    formBody.hidden=false;
  }
  setFormEnabled(true);
  const firstInput=form.querySelector('.form-body input, .form-body select, .form-body textarea');
  if(firstInput){
    try{firstInput.focus();}catch{}
  }
};

const startSubmitting=()=>{
  if(isSubmitting) return;
  isSubmitting=true;
  submitBtn.textContent='Submitting...';
  submitBtn.classList.add('is-submitting');
  showMsg('Submitting...');
  setFormEnabled(false);
};

const endSubmitting=()=>{
  isSubmitting=false;
  submitBtn.classList.remove('is-submitting');
  submitBtn.textContent=submitBtnDefaultText;
  if(REGISTRATIONS_OPEN){
    setFormEnabled(true);
  }
};

const ensureRecaptchaReady=()=>{
  if(!SITE_KEY) return Promise.resolve();
  if(window.grecaptcha){
    return new Promise(resolve=>{window.grecaptcha.ready(resolve);});
  }
  if(!recaptchaReadyPromise){
    recaptchaReadyPromise=new Promise((resolve,reject)=>{
      const script=document.createElement('script');
      script.src=`https://www.google.com/recaptcha/api.js?render=${SITE_KEY}`;
      script.async=true;
      script.defer=true;
      script.onerror=()=>reject(new Error('recaptcha script failed to load'));
      script.onload=()=>{
        if(window.grecaptcha){
          window.grecaptcha.ready(resolve);
        }else{
          reject(new Error('reCAPTCHA unavailable'));
        }
      };
      document.head.appendChild(script);
    });
  }
  return recaptchaReadyPromise;
};
if(dobInput){
  const today=new Date();
  const y=today.getFullYear();
  const m=String(today.getMonth()+1).padStart(2,'0');
  const d=String(today.getDate()).padStart(2,'0');
  dobInput.max=`${y}-${m}-${d}`;
}
if(phoneInput){
  phoneInput.setAttribute('pattern','^\\+91[6-9][0-9]{9}$');
  if(!phoneInput.value.trim()){
    phoneInput.value='+91';
  }
  const enforcePhoneFormat=()=>{
    const selectionStart=phoneInput.selectionStart??phoneInput.value.length;
    const raw=phoneInput.value||'';
    const digits=raw.replace(/\D/g,'').slice(0,12);
    let subscriber='';
    if(digits.startsWith('91')){
      subscriber=digits.slice(2);
    }else if(digits.startsWith('0')){
      subscriber=digits.slice(1);
    }else if(digits.length<=2){
      subscriber='';
    }else{
      subscriber=digits;
    }
    subscriber=subscriber.slice(0,10);
    const formatted=`+91${subscriber}`;
    phoneInput.value=formatted;
    if(document.activeElement===phoneInput){
      const relativePos=Math.max(0,selectionStart-3);
      const nextPos=Math.max(3,Math.min(formatted.length,3+relativePos));
      requestAnimationFrame(()=>phoneInput.setSelectionRange(nextPos,nextPos));
    }
  };
  phoneInput.addEventListener('input',enforcePhoneFormat);
  phoneInput.addEventListener('blur',()=>{
    if(!phoneInput.value.trim()){
      phoneInput.value='+91';
    }else{
      enforcePhoneFormat();
    }
  });
  phoneInput.addEventListener('focus',()=>{
    if(!phoneInput.value.trim()){
      phoneInput.value='+91';
    }
    enforcePhoneFormat();
  });
}
const clearMsg=()=>{msg.hidden=true;msg.textContent='';msg.classList.remove('note--success','note--error')};
const showMsg=(text,type)=>{
  msg.hidden=false;msg.textContent=text;msg.classList.remove('note--success','note--error');
  if(type==='success')msg.classList.add('note--success');
  if(type==='error')msg.classList.add('note--error');
};
const showSuccessModal=text=>{
  successMessage.textContent=text;
  successModal.hidden=false;
};
const hideSuccessModal=()=>{successModal.hidden=true;};
if(successClose){
  successClose.addEventListener('click',()=>{
    hideSuccessModal();
    window.location.href='/';
  });
  successModal.addEventListener('click',e=>{
    if(e.target===successModal){
      hideSuccessModal();
      window.location.href='/';
    }
  });
}
if(cancelBtn){
  cancelBtn.addEventListener('click',()=>{
    form.reset();
    if(phoneInput){
      phoneInput.value='+91';
    }
    clearMsg();
    endSubmitting();
  });
}
const normalizePhone=input=>{
  if(!input)return null;
  const digits=input.replace(/\D/g,'');
  const ensureValidTen=ten=>INDIAN_MOBILE_REGEX.test(ten)?ten:null;
  if(digits.length===10){
    const ten=ensureValidTen(digits);
    return ten?`+91${ten}`:null;
  }
  if(digits.length===11&&digits.startsWith('0')){
    const ten=ensureValidTen(digits.slice(1));
    return ten?`+91${ten}`:null;
  }
  if(digits.length===12&&digits.startsWith('91')){
    const ten=ensureValidTen(digits.slice(2));
    return ten?`+${digits}`:null;
  }
  if(digits.length===13&&digits.startsWith('091')){
    const candidate=digits.slice(1);
    const ten=ensureValidTen(candidate.slice(2));
    return ten?`+${candidate}`:null;
  }
  return null;
};
const calcAgeYears=dobStr=>{
  const date=new Date(dobStr);
  if(Number.isNaN(date.getTime()))return NaN;
  const today=new Date();
  let age=today.getFullYear()-date.getFullYear();
  const monthDiff=today.getMonth()-date.getMonth();
  if(monthDiff<0||(monthDiff===0&&today.getDate()<date.getDate()))age--;
  return age;
};
const errorMessages={
  missing_fields:'Please fill in all required fields.',
  invalid_email:'Please use a valid email address.',
  email_exists:'This email is already registered.',
  server_error:'Submission failed. Email contact@bugbash.me.',
  registrations_closed:'Registrations are currently paused. Check back soon.',
  invalid_captcha:'Please complete the CAPTCHA challenge.',
  captcha_failed:'We could not verify you are human. Reload and try again.',
  invalid_phone:'Phone number must be an Indian mobile (+91, starts with 6/7/8/9).',
  github_required:'Connect your GitHub account before registering.'
};

const setGithubStatus=(text,type)=>{
  if(!githubStatus)return;
  githubStatus.hidden=!text;
  githubStatus.textContent=text||'';
  githubStatus.classList.remove('note--success','note--error');
  if(type==='success')githubStatus.classList.add('note--success');
  if(type==='error')githubStatus.classList.add('note--error');
};

const prefillFromGithub=profile=>{
  if(!profile||typeof profile!=='object')return;
  const nameValue=(profile.name||profile.login||'').trim();
  const emailValue=(profile.email||'').trim();
  const profileUrl=(profile.profileUrl||'').trim();
  const fullNameInput=form.querySelector('input[name="full_name"]');
  const emailInput=form.querySelector('input[name="email"]');
  const profileLinkInput=form.querySelector('input[name="profile_link"]');
  if(fullNameInput&&nameValue){fullNameInput.value=nameValue;}
  if(emailInput&&emailValue){emailInput.value=emailValue;}
  if(profileLinkInput&&profileUrl){profileLinkInput.value=profileUrl;}
  if(githubUserLabel){
    const display=nameValue||profile.login||'';
    if(display){
      githubUserLabel.textContent=`Connected as ${display}`;
      githubUserLabel.hidden=false;
    }else{
      githubUserLabel.textContent='';
      githubUserLabel.hidden=true;
    }
  }
};

const startGithubOAuth=()=>{
  if(!GITHUB_AUTH_ENABLED||!githubBtn)return;
  if(!REGISTRATIONS_OPEN){
    setGithubStatus(errorMessages.registrations_closed,'error');
    return;
  }
  const labelSpan=githubBtn.querySelector('span');
  if(labelSpan){labelSpan.textContent='Continue with GitHub';}
  githubBtn.disabled=true;
  githubBtn.classList.add('is-submitting');
  setGithubStatus('Redirecting to GitHub...',null);
  const params=new URLSearchParams(window.location.search);
  params.delete('github_token');
  const currentTarget=`${window.location.pathname}${params.toString()?`?${params.toString()}`:''}${window.location.hash}`;
  window.location.href=`/api/auth/github/start?returnTo=${encodeURIComponent(currentTarget||'/register.html')}`;
};

const processGithubToken=async token=>{
  if(!GITHUB_AUTH_ENABLED||!token)return;
  const previousSession=githubSessionToken;
  const previousProfile=githubProfileData;
  const wasConnected=githubConnected;
  if(githubBtn){
    githubBtn.disabled=true;
    githubBtn.classList.add('is-submitting');
  }
  githubSessionToken='';
  githubProfileData=null;
  githubAlreadyRegistered=false;
  setGithubStatus('Loading GitHub details...',null);
  try{
    const response=await fetch(`/api/auth/github/profile/${encodeURIComponent(token)}`,{headers:{Accept:'application/json'}});
    const payload=await response.json();
    if(!response.ok||!payload||payload.ok===false||!payload.profile||!payload.sessionToken){
      throw new Error(payload?.error||'profile_not_found');
    }
    githubSessionToken=payload.sessionToken;
    githubProfileData=payload.profile;
    githubAlreadyRegistered=Boolean(payload.alreadyRegistered);
    githubConnected=true;
    prefillFromGithub(githubProfileData);
    clearMsg();
    if(githubAuthBlock){
      githubAuthBlock.classList.add('is-connected');
    }
    if(githubBtn){
      githubBtn.disabled=false;
      githubBtn.classList.remove('is-submitting');
      const label=githubBtn.querySelector('span');
      if(label){
        label.textContent='Switch GitHub account';
      }
    }
    const displayName=(githubProfileData.name||githubProfileData.login||'').trim()||'GitHub user';
    if(githubAlreadyRegistered){
      formLocked=true;
      if(formBody){
        formBody.hidden=true;
      }
      setFormEnabled(false);
      setGithubStatus('', null);
      showSuccessModal(`You already registered as ${displayName}. We'll see you at Bug Bash!`);
      return;
    }
    if(githubHint){githubHint.hidden=true;}
    if(formLocked){
      unlockForm();
    }
    setGithubStatus('Review your details and submit the form.', 'success');
  }catch(err){
    console.error('GitHub profile fetch failed',err);
    githubSessionToken=previousSession;
    githubProfileData=previousProfile;
    githubConnected=wasConnected;
    if(!wasConnected&&githubUserLabel){
      githubUserLabel.textContent='';
      githubUserLabel.hidden=true;
    }
    if(!githubConnected&&githubHint){githubHint.hidden=false;}
    if(!wasConnected&&githubAuthBlock){
      githubAuthBlock.classList.remove('is-connected');
    }
    if(githubBtn){
      githubBtn.disabled=false;
      githubBtn.classList.remove('is-submitting');
      const label=githubBtn.querySelector('span');
      if(label){label.textContent='Retry GitHub';}
    }
    setGithubStatus('GitHub session expired. Hit “Continue with GitHub” again to refresh.', 'error');
  }
};

if(GITHUB_AUTH_ENABLED&&githubBtn){
  githubBtn.addEventListener('click',startGithubOAuth);
  const params=new URLSearchParams(window.location.search);
  const githubToken=params.get('github_token');
  if(githubToken){
    params.delete('github_token');
    const cleaned=params.toString();
    const newUrl=`${window.location.pathname}${cleaned?`?${cleaned}`:''}${window.location.hash}`;
    try{history.replaceState(null,'',newUrl);}catch{}
    processGithubToken(githubToken);
  }
}

setFormEnabled(false);
if(GITHUB_AUTH_ENABLED){
  setGithubStatus('Connect your GitHub account to begin registration.',null);
}else{
  setGithubStatus('GitHub sign-in is unavailable right now. Registration is temporarily paused.', 'error');
}

if(!REGISTRATIONS_OPEN){
  formLocked=true;
  setFormEnabled(false);
  showMsg(errorMessages.registrations_closed,'error');
}
form.addEventListener('input',()=>{if(!msg.hidden)clearMsg()});
form.addEventListener('submit',async(e)=>{
  e.preventDefault();
  if(!REGISTRATIONS_OPEN){
    showMsg(errorMessages.registrations_closed,'error');
    return;
  }
  if(!githubConnected||!githubSessionToken){
    showMsg(errorMessages.github_required,'error');
    return;
  }
  if(githubAlreadyRegistered){
    showSuccessModal('You already registered with this GitHub account. We\'ll see you at Bug Bash!');
    return;
  }
  const entries=new FormData(form).entries();
  const data={};
  for(const [key,value] of entries){
    data[key]=typeof value==='string'?value.trim():value;
  }
  data.github_session=githubSessionToken;
  if(githubProfileData&&githubProfileData.login){
    data.github_login=githubProfileData.login;
  }
  const phoneRaw=data.phone||'';
  const emailValue=data.email||'';
  const normalizedPhone=normalizePhone(phoneRaw);
  const dobValue=data.dob||'';
  const age=calcAgeYears(dobValue);
  const birthDateValid=!Number.isNaN(new Date(dobValue).getTime());
  const today=new Date();
  const dobDate=birthDateValid?new Date(dobValue):null;
  const sizeValue=data.size||'';
  if(!EMAIL_REGEX.test(emailValue)){showMsg(errorMessages.invalid_email,'error');return;}
  if(phoneRaw.replace(/\D/g,'').length<10){showMsg('Please add your phone number.','error');return;}
  if(!normalizedPhone){showMsg(errorMessages.invalid_phone,'error');return;}
  if(!dobValue||!birthDateValid){showMsg('Please provide a valid date of birth.','error');return;}
  if(dobDate&&dobDate>today){showMsg('Date of birth cannot be in the future.','error');return;}
  if(Number.isNaN(age)){showMsg('Please provide a valid date of birth.','error');return;}
  if(age>21){showMsg('Only participants aged 21 or below can register.','error');return;}
  if(!sizeValue){showMsg('Please choose a T-shirt size.','error');return;}
  data.phone=normalizedPhone;
  data.size=sizeValue;
  data.heard_from=data.referral||'';
  const originalNotes=data.notes||'';
  data.notes=originalNotes;
  if(SITE_KEY){
    try{
      await ensureRecaptchaReady();
      const token=await window.grecaptcha.execute(SITE_KEY,{action:'register'});
      if(!token){throw new Error('empty token');}
      data.captchaToken=token;
    }catch(recaptchaErr){
      console.error('reCAPTCHA error',recaptchaErr);
      showMsg(errorMessages.captcha_failed,'error');
      return;
    }
  }
  startSubmitting();
  let submissionSucceeded=false;
  try{
    const r=await fetch('/api/register',{method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},body:JSON.stringify(data)});
    const ct=r.headers.get('content-type')||'';const expectJson=ct.includes('application/json');
    let payload=null;
    if(expectJson){try{payload=await r.json();}catch(parseErr){console.warn('Could not parse register response JSON',parseErr);}}
    if(r.ok){
      if(payload&&payload.ok===false){
        const errKey=payload.error;
        showMsg(errorMessages[errKey]||'Submission failed. Email contact@bugbash.me.','error');
        console.error('Registration rejected',payload);
      }else{
        clearMsg();
        form.reset();
        if(phoneInput){
          phoneInput.value='+91';
        }
        submissionSucceeded=true;
        submitBtn.classList.remove('is-submitting');
        submitBtn.textContent='Submitted!';
        showSuccessModal('Check your email for confirmation soon. You will be redirected.');
        setTimeout(()=>{window.location.href='/'},2800);
      }
    }
    else if(payload&&payload.error){
      const errKey=payload.error;
      showMsg(errorMessages[errKey]||'Submission failed. Email contact@bugbash.me.','error');
      console.error('Registration error',payload);
      if(errKey==='registrations_closed'){
        setFormEnabled(false);
      }
    }
    else{showMsg('Submission failed. Email contact@bugbash.me.','error');if(!expectJson)console.error('Registration failed',r.status);}
  }catch(err){showMsg('Network error. Try again.','error');console.error('Registration request error',err);} 
  finally{
    if(!submissionSucceeded){
      endSubmitting();
    }
  }
});
</script>
</body>
</html>
